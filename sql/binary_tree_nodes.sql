SELECT N, CASE
WHEN P IS NULL THEN 'Root'
ELSE CASE
    WHEN EXISTS (SELECT P FROM BST B WHERE A.N = B.P) THEN 'Inner'
    ELSE 'Leaf'
    END
END FROM BST A
ORDER BY N
